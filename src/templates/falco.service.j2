# Copyright 2025 Canonical Ltd.
# See LICENSE file for licensing details.
# See https://github.com/falcosecurity/falco/blob/master/scripts/systemd/falco-modern-bpf.service

[Unit]
Description=Falco: Container Native Runtime Security with modern ebpf
Documentation=https://falco.org/docs/

[Service]
Type=simple
ExecStart={{ command }} -c {{ config_file }} -r {{ rules_dir }} -o engine.kind=modern_ebpf
ExecReload=kill -1 $MAINPID
User=root
UMask=0077
TimeoutSec=30
RestartSec=15s
Restart=on-failure
PrivateTmp=true
NoNewPrivileges=yes
ProtectHome=read-only
ProtectSystem=full
ProtectKernelTunables=true
RestrictRealtime=true
RestrictAddressFamilies=~AF_PACKET
StandardOutput=null

[Install]
WantedBy=multi-user.target
